import{_ as D,C as T,N as L,E as y,L as M,H as r,F as t,r as h,z as R,I as f,J as v,D as Q,M as k,Q as U}from"./index-wrgDkh8i.js";import{Q as V}from"./QInput-BMk3XvRE.js";import{Q as q,a as b,b as g}from"./QTable-904eT4N7.js";import{Q as B}from"./QTooltip-CnaKLnlG.js";import{a as N,Q as E}from"./QCard-1WAaiELz.js";import{u as x}from"./use-quasar-BPO0058G.js";import{a as F}from"./index-DW_MHI2K.js";import"./use-dark-PIVIBmqD.js";import"./format-CZkItrcI.js";import"./scroll-Bd05ITzt.js";import"./QItem-BsDwLedE.js";import"./position-engine--NHZi2nF.js";import"./selection-BZ0LLMlN.js";import"./use-timeout-CZEsKGPm.js";function $(o){setTimeout(()=>{window.URL.revokeObjectURL(o.href)},1e4),o.remove()}function j(o,n,i={}){const{mimeType:d,byteOrderMark:p,encoding:m}=typeof i=="string"?{mimeType:i}:i,e=m!==void 0?new TextEncoder(m).encode([n]):n,l=p!==void 0?[p,e]:[e],w=new Blob(l,{type:d||"application/octet-stream"}),s=document.createElement("a");s.href=window.URL.createObjectURL(w),s.setAttribute("download",o),typeof s.download>"u"&&s.setAttribute("target","_blank"),s.classList.add("hidden"),s.style.position="fixed",document.body.appendChild(s);try{return s.click(),$(s),!0}catch(_){return $(s),_}}function A(o,n){let i=n!==void 0?n(o):o;return i=i==null?"":String(i),i=i.split('"').join('""'),`"${i}"`}const I=T({name:"TableVisits",setup(){const o=x(),n=h(""),i=h([]),d={1:"Razonamiento Matemático",2:"Razonamiento Verbal",3:"Física, Química y Biología",4:"Geografía e Historia"},p={1:"Unap",2:"Particular"},m=a=>({1:"blue",2:"green",3:"red",4:"orange"})[a]||"grey",e=[{name:"id",align:"left",label:"ID",field:"id",sortable:!0},{name:"nombre_completo",align:"left",label:"Nombres",field:a=>`${a.nombres} ${a.paterno} ${a.materno}`,sortable:!0},{name:"nro_documento",align:"nro_documento",label:"Nro Documento",field:"nro_documento"},{name:"area",align:"left",label:"Área",field:a=>d[a.area]||"Desconocida",sortable:!0},{name:"celular",align:"left",label:"Celular",field:"celular"},{name:"condicion",align:"left",label:"Condicion",field:"condicion",sortable:!0},{name:"asistencia",align:"left",label:"Asistencia D1",field:"asistencia"},{name:"asistencia_d1_2",align:"left",label:"Asistencia D1-2",field:"asistencia_d1_2"},{name:'asistencia_d2"',align:"left",label:"Asistencia D2",field:"asistencia_d2"},{name:"path",align:"left",label:"Ficha",field:"path"}],l=h({rowsPerPage:10}),w=async()=>{try{const a=await F.get("https://sistemas.cepreuna.edu.pe/api/curso-taller/inscripciones",{headers:{Authorization:"cepreuna_v1_api"}});i.value=a.data.listado}catch(a){console.error("Error al obtener los datos:",a)}},s=()=>{const a=[e.map(c=>A(c.label))].concat(i.value.map(c=>e.map(u=>A(typeof u.field=="function"?u.field(c):c[u.field||u.name],u.format)).join(","))).join(`\r
`);j("table-export.csv",a,"text/csv")!==!0&&o.notify({message:"El navegador bloqueó la descarga...",color:"negative",icon:"warning"})};return R(()=>{w()}),{filter:n,columns:e,rows:i,pagination:l,exportTable:s,areaMap:d,openFile:a=>{if(!a){this.$q.notify({message:"No hay archivo disponible",color:"negative",icon:"warning"});return}const c=a.startsWith("http")?a:`https://sistemas.cepreuna.edu.pe/${a}`;window.open(c,"_blank")},CondicioMap:p,getAreaColor:m}}}),z={class:"row q-col-gutter-sm"},P={class:"col-lg-12 col-md-12 col-sm-12 col-xs-12"};function S(o,n,i,d,p,m){return y(),L("div",z,[M("div",P,[r(N,{class:"text-grey-8 no-shadow",bordered:""},{default:t(()=>[r(E,{class:"q-pa-none"},{default:t(()=>[r(q,{class:"no-shadow",rows:o.rows,title:"Lista de Registros",columns:o.columns,"row-key":"id",filter:o.filter,pagination:o.pagination,"onUpdate:pagination":n[1]||(n[1]=e=>o.pagination=e)},{"top-right":t(e=>[r(V,{dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":n[0]||(n[0]=l=>o.filter=l),placeholder:"Buscar"},{append:t(()=>[r(U,{name:"search"})]),_:1},8,["modelValue"]),r(k,{color:"primary","icon-right":"archive",label:"Exportar","no-caps":"",onClick:o.exportTable},null,8,["onClick"])]),"body-cell-area":t(e=>[r(b,{props:e},{default:t(()=>[r(g,{color:o.getAreaColor(e.row.area),class:"q-pa-xs"},{default:t(()=>[f(v(o.areaMap[e.row.area]||"Desconocida"),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-condicion":t(e=>[r(b,{props:e},{default:t(()=>[r(g,{color:o.getAreaColor(e.row.condicion),class:"q-pa-xs"},{default:t(()=>[f(v(o.CondicioMap[e.row.condicion]||"Desconocida"),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-path":t(e=>[r(b,{props:e},{default:t(()=>[e.row.path?(y(),Q(k,{key:0,flat:"",round:"",dense:"",color:"info",icon:"file_open",class:"q-ml-sm",onClick:l=>o.openFile(e.row.path)},{default:t(()=>[r(B,null,{default:t(()=>n[2]||(n[2]=[f("Ver Archivo")])),_:1})]),_:2},1032,["onClick"])):(y(),Q(g,{key:1,color:"negative"},{default:t(()=>n[3]||(n[3]=[f("Sin archivo")])),_:1}))]),_:2},1032,["props"])]),"body-cell-asistencia":t(e=>[r(b,{props:e},{default:t(()=>[r(g,{color:e.row.asistencia===1?"green":"red",class:"q-pa-xs"},{default:t(()=>[f(v(e.row.asistencia===1?"Asistió":"No Asistió"),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter","pagination"])]),_:1})]),_:1})])])}const ie=D(I,[["render",S]]);export{ie as default};
